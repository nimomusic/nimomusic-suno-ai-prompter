<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NIMO MUSIC AI PROMPTER</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;900&family=Noto+Sans+KR:wght@400;700;900&display=swap');
        body { font-family: 'Inter', 'Noto Sans KR', sans-serif; background-color: #f8fafc; scroll-behavior: smooth; -webkit-user-select: none; user-select: none; }
        .btn-active { background: #2563eb !important; color: white !important; box-shadow: 0 4px 12px rgba(37, 99, 235, 0.3); transform: scale(0.98); }
        .animate-fade { animation: fadeIn 0.4s ease-out forwards; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .label-text { font-size: 16px; font-weight: 900; color: #000; text-transform: uppercase; letter-spacing: 0.05em; font-style: italic; }
        .switch { position: relative; display: inline-block; width: 44px; height: 22px; }
        .switch input { opacity: 0; width: 0; height: 0; }
        .slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #e2e8f0; transition: .4s; border-radius: 22px; }
        .slider:before { position: absolute; content: ""; height: 16px; width: 16px; left: 3px; bottom: 3px; background-color: white; transition: .4s; border-radius: 50%; }
        input:checked + .slider { background-color: #2563eb; }
        input:checked + .slider:before { transform: translateX(22px); }
    </style>
</head>
<body>
    <div id="root"></div>

    <script>
        // 기초 보안: 우클릭 방지
        document.oncontextmenu = () => false;
        document.onkeydown = (e) => {
            if (e.keyCode === 123 || (e.ctrlKey && e.shiftKey && (e.keyCode === 73 || e.keyCode === 74)) || (e.ctrlKey && e.keyCode === 85)) return false;
        };
    </script>

    <script type="text/babel">
        const { useState, useEffect, useCallback } = React;
        const API_URL = "/api";

        const decryptKey = (enc) => atob(enc.split('').reverse().join(''));

        // [수정된 원본 데이터 리스트]
        // 추가하신 긴 단어들이 잘 보이도록 CSS를 수정했습니다.
        const OPTIONS = {
            eras: { 
                ko: ['중세', '르네상스', '바로크', '고전주의', '낭만주의', '1950s', '1960s', '1970s', '1980s', '1990s', '2000s', '2010s', '2020s', '미래적', '조선'], 
                en: ['Medieval', 'Renaissance', 'Baroque', 'Classical', 'Romantic', '1950s', '1960s', '1970s', '1980s', '1990s', '2000s', '2010s', '2020s', 'Futuristic', 'Chosun']
            },
            genres: {
                ko: ['발라드', '팝', '록', '일렉트로닉', '힙합', 'R&B', '재즈', '클래식', '포크', '인디', '컨트리', '트로트', '국악', '판소리', '사극', '민요', '블루스', '레게', '메탈', '펑크', '디스코', '소울', 'EDM', '하우스', '테크노', '트랜스', '덥스텝', '드럼 앤 베이스', '트랩', '보사노바', '플라멩코', '탱고', 'K-POP', 'J-POP', '시티팝', '신스팝', '뉴에이지', '앰비언트', '칠아웃', '로파이', '포스트록', '가스펠', '인더스트리얼', '흑인영가', '그런지', '펑크록', '하드록', '프로그레시브록'],
                en: ['Ballad', 'Pop', 'Rock', 'Electronic', 'Hip-Hop', 'R&B', 'Jazz', 'Classical', 'Folk', 'Indie', 'Country', 'K-trot', 'Gukak', 'Pansori', 'Sageuk', 'Minyo', 'Blues', 'Reggae', 'Metal', 'Punk', 'Disco', 'Soul', 'EDM', 'House', 'Techno', 'Trance', 'Dubstep', 'Drum and Bass', 'Trap', 'Bossa Nova', 'Flamenco', 'Tango', 'K-POP', 'J-POP', 'City Pop', 'Synth-pop', 'New Age', 'Ambient', 'Chillout', 'Lo-fi', 'Post-rock', 'Gospel', 'Industrial', 'Spirituals', 'Grunge', 'Punk Rock', 'Hard Rock', 'Progressive Rock']
            },
            moods: {
                ko: ['감성적인', '경쾌한', '우울한', '에너제틱', '로맨틱', '그루비한', '평화로운', '긴장감 있는', '희망적인', '신비로운', '강렬한', '따뜻한', '차가운', '몽환적인', '어두운', '밝은', '슬픈', '화난', '섹시한', '유쾌한', '멜랑콜리한', '향수를 자극하는', '웅장한', '섬세한', '거친', '부드러운', '극적인', '서정적인', '애절한', '장난스러운', '진지한', '반항적인', '고요한', '격정적인', '황홀한'],
                en: ['Emotional', 'Upbeat', 'Melancholic', 'Energetic', 'Romantic', 'Groovy', 'Peaceful', 'Tense', 'Hopeful', 'Mysterious', 'Intense', 'Warm', 'Cold', 'Dreamy', 'Dark', 'Bright', 'Sad', 'Angry', 'Sexy', 'Cheerful', 'Melancholy', 'Nostalgic', 'Epic', 'Delicate', 'Rough', 'Smooth', 'Dramatic', 'Lyrical', 'Heartbreaking', 'Playful', 'Serious', 'Rebellious', 'Serene', 'Passionate', 'Euphoric']
            },
            vocals: {
                ko: ['남성 보컬', '여성 보컬', '남성 듀엣', '여성 듀엣', '남녀 듀엣', '혼성 합창', '남성 합창', '여성 합창', '어린이 합창', '아카펠라', '랩', '말하듯노래', '보컬 없음', '허밍', '휘파람', '비브라토', '가성', '하모니', '백그라운드 보컬', '부드러운', '파워풀한', '낮은', '거친', '속삭이는', '감성적인', '공기섞인', '오토튠', '소울풀한', '어린아이같은', '부드러운', '탁하고 강한', '여러층', '최소한의', '빠른 랩', '숨가쁜', '멜리스마 R&B'],
                en: ['Male Vocal', 'Female Vocal', 'Male Duet', 'Female Duet', 'Mixed Duet', 'Mixed Choir', 'Male Choir', 'Female Choir', 'Children Choir', 'A Cappella', 'Rap', 'Spoken Word', 'No Vocal', 'Humming', 'Whistling', 'Vibrato', 'Falsetto', 'Harmony', 'Background Vocal', 'Soft', 'Powerful', 'Deep', 'Raspy', 'Whispered', 'Emotional', 'Airy', 'Auto-tuned', 'Soulful', 'Childlike', 'Smooth', 'Gritty', 'Layered', 'Minimalist', 'Fast rap', 'Breathless delivery', 'Melismatic R&B']
            },
            instruments: {
                ko: ['어쿠스틱 기타', '일렉트릭 기타', '베이스 기타', '피아노', '신시사이저', '드럼', '일렉트로닉 드럼', '첼로', '바이올린', '비올라', '더블베이스', '하프', '플루트', '색소폰', '트럼펫', '트롬본', '클라리넷', '하모니카', '아코디언', '밴조', '만돌린', '우쿨렐레', '타블라', '봉고', '콩가', '마림바', '오르간', '스트링 섹션', '브라스 섹션', '퍼커션', '808 베이스', '샘플링', '루프', '패드 사운드'],
                en: ['acoustic guitar', 'electric guitar', 'bass guitar', 'piano', 'synthesizer', 'drums', 'electronic drums', 'cello', 'violin', 'viola', 'double bass', 'harp', 'flute', 'saxophone', 'trumpet', 'trombone', 'clarinet', 'harmonica', 'accordion', 'banjo', 'mandolin', 'ukulele', 'tabla', 'bongo', 'conga', 'marimba', 'organ', 'string section', 'brass section', 'percussion', '808 bass', 'sampling', 'loops', 'pad sounds']
            },
            mixingStyles: {
                ko: ['가까이서 들리는', '시네마틱', '하이파이', '로파이', '빈티지', '모던', '무가공', '세련되게', '미니멀리스트', '여러 층', '공간감', '소리균형', '리버브 헤비', '드라이', '스테레오 와이드', '모노', '아날로그', '디지털', '글리치', '디스토션', '클린', '크런치', '페이저', '코러스', '딜레이', '에코', 'A/B 스테레오', '프로덕션', '실험적', '대중적'],
                en: ['intimate', 'cinematic', 'high-fidelity', 'lo-fi', 'vintage', 'modern', 'raw', 'polished', 'minimalist', 'layered', 'ambient', 'compressed', 'reverb heavy', 'dry', 'stereo wide', 'mono', 'analog', 'digital', 'glitch', 'distortion', 'clean', 'crunch', 'phaser', 'chorus', 'delay', 'echo', 'A/B stereo', 'production', 'experimental', 'mainstream']
            }
        };

        const RenderOptions = React.memo(({ label, field, list, selectedValues, onToggle, onReset, isAuto, onAutoToggle }) => (
            <div className="mb-10">
                <div className="flex justify-between items-center mb-4">
                    <div className="flex items-center gap-4">
                        <label className="label-text">{label}</label>
                        {onAutoToggle && (
                            <div className="flex items-center gap-2 bg-gray-100 px-3 py-1 rounded-full">
                                <span className="text-[11px] font-black text-gray-500 uppercase">Auto</span>
                                <label className="switch">
                                    <input type="checkbox" checked={isAuto} onChange={onAutoToggle} />
                                    <span className="slider"></span>
                                </label>
                            </div>
                        )}
                    </div>
                    {onReset && (
                        <button onClick={onReset} className="text-[10px] font-black text-red-400 hover:text-red-600 border border-red-100 px-3 py-1 rounded-full transition-all bg-red-50">
                            <i className="fa-solid fa-rotate-left mr-1"></i> RESET
                        </button>
                    )}
                </div>
                {!isAuto ? (
                    /* CSS 수정: 긴 텍스트 대응 (h-auto, min-h, leading-tight 등) */
                    <div className="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-2 animate-fade">
                        {list.map(val => (
                            <button key={val} onClick={(e) => onToggle(e, field, val)}
                                className={`px-2 py-3 min-h-[44px] h-auto rounded-xl text-[11px] font-bold transition-all border break-keep leading-tight ${selectedValues.includes(val) ? 'btn-active border-blue-600' : 'bg-white text-gray-400 border-gray-100 hover:border-blue-200'}`}>
                                {val}
                            </button>
                        ))}
                    </div>
                ) : (
                    <div className="py-6 bg-blue-50/30 border border-dashed border-blue-100 rounded-2xl text-[12px] font-bold text-blue-400 text-center animate-fade italic">
                        <i className="fa-solid fa-robot mr-2"></i> AI가 테마에 맞춰 최적의 조합을 벤치마킹합니다.
                    </div>
                )}
            </div>
        ));

        const SunoPromptGenerator = ({ userPw }) => {
            const [language, setLanguage] = useState('ko'); 
            const [isGenerating, setIsGenerating] = useState(false);
            const [result, setResult] = useState(null);
            const [showSettings, setShowSettings] = useState(false);
            const [showHelp, setShowHelp] = useState(false);
            const [apiKey, setApiKey] = useState('');
            const [isAutoInstruments, setIsAutoInstruments] = useState(true);
            const [isAutoMixing, setIsAutoMixing] = useState(true);

            const initialFormState = { genre: [], era: [], mood: [], vocal: [], instruments: [], mixing: [], theme: '', lyricsLanguage: 'ko' };
            const [formData, setFormData] = useState(initialFormState);

            useEffect(() => {
                const saved = localStorage.getItem('_nimo_gemini_key');
                if (saved) setApiKey(decryptKey(saved));
            }, []);

            const toggleSelection = useCallback((e, field, value) => {
                e.preventDefault();
                setFormData(prev => ({ ...prev, [field]: prev[field].includes(value) ? prev[field].filter(v => v !== value) : [...prev[field], value] }));
            }, []);

            const generatePrompt = async () => {
                const savedKey = localStorage.getItem('_nimo_gemini_key');
                if (!savedKey) { setShowSettings(true); return; }
                if (formData.genre.length === 0 || !formData.theme) { alert(language === 'ko' ? "장르와 테마를 입력하세요." : "Please select Genre and enter Theme."); return; }

                setIsGenerating(true);
                try {
                    const res = await fetch(`${API_URL}/generate`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            theme: formData.theme,
                            formData: { ...formData, isAutoInstruments, isAutoMixing },
                            apiKey: decryptKey(savedKey),
                            password: userPw
                        })
                    });
                    const data = await res.json();
                    if (!res.ok) throw new Error(data.error || "API Error");
                    setResult(data.result.replace(/\*/g, '').replace(/#/g, ''));
                    window.scrollTo({ top: 0, behavior: 'smooth' });
                } catch (err) { alert(`Error: ${err.message}`); }
                finally { setIsGenerating(false); }
            };

            const parseResult = (text) => {
                if (!text) return { title: '', style: '', lyrics: '' };
                const title = text.match(/Title:\s*(.*)/i)?.[1] || 'Untitled';
                const style = text.match(/Style Prompt:\s*([\s\S]*?)(?=Lyrics:|$)/i)?.[1] || '';
                const lyrics = text.match(/Lyrics:\s*([\s\S]*)/i)?.[1] || '';
                return { title, style, lyrics };
            };

            const p = parseResult(result);

            const t = {
                title: language === 'ko' ? '니모뮤직 고품질 프롬프트 생성기' : "NIMO MUSIC - Hifi prompt generator",
                help: language === 'ko' ? '도움말' : 'HELP',
                apiKey: language === 'ko' ? 'API 설정' : 'API KEY',
                reset: language === 'ko' ? '초기화' : 'RESET',
                genreLabel: language === 'ko' ? '장르 / GENRE' : 'GENRE',
                eraLabel: language === 'ko' ? '시대 / ERA' : 'ERA',
                moodLabel: language === 'ko' ? '무드 / MOOD' : 'MOOD',
                vocalLabel: language === 'ko' ? '보컬 / VOCAL' : 'VOCAL',
                instLabel: language === 'ko' ? '악기 / INSTRUMENTS' : 'INSTRUMENTS',
                mixLabel: language === 'ko' ? '믹싱 / MIXING' : 'MIXING',
                langLabel: language === 'ko' ? '가사 언어 / LYRICS LANGUAGE' : 'LYRICS LANGUAGE',
                themeLabel: language === 'ko' ? '테마 / THEME & STORY' : 'THEME & STORY',
                themePlaceholder: language === 'ko' ? '이야기를 적어주세요...' : 'Enter your story...',
                generateBtn: language === 'ko' ? '프롬프트 생성하기' : 'GENERATE PROMPT',
                loading: language === 'ko' ? 'AI 분석 중...' : 'AI ANALYZING...',
                restart: language === 'ko' ? '다시 시작' : 'Restart',
                langChoices: {
                    ko: language === 'ko' ? ['한국어', '영어', '일본어'] : ['KOREAN', 'ENGLISH', 'JAPANESE']
                }
            };

            return (
                <div className="min-h-screen pb-20">
                    <header className="bg-white/80 backdrop-blur-md border-b sticky top-0 z-40 px-6 py-4">
                        <div className="max-w-7xl mx-auto flex items-center justify-between relative">
                            <div className="w-32 hidden md:block"></div>
                            <div className="md:absolute md:left-1/2 md:transform md:-translate-x-1/2 font-black italic text-xl text-blue-600 tracking-tighter text-center">
                                <i className="fa-solid fa-bolt mr-2"></i>{t.title}
                            </div>
                            <div className="flex gap-2 items-center">
                                <button onClick={() => setShowHelp(true)} className="px-4 py-2 rounded-full bg-blue-50 text-blue-600 text-[11px] font-black border border-blue-100 hover:bg-blue-100 transition-all">
                                    <i className="fa-solid fa-circle-question mr-1"></i> {t.help}
                                </button>
                                <button onClick={() => setShowSettings(true)} className="px-4 py-2 rounded-full bg-gray-100 text-[11px] font-black hover:bg-gray-200">
                                    <i className="fa-solid fa-key mr-1"></i> {t.apiKey}
                                </button>
                                <button onClick={() => setLanguage(l => l === 'ko' ? 'en' : 'ko')} className="min-w-[80px] h-10 px-3 rounded-full bg-black text-white text-[10px] font-black hover:scale-105 transition-all">
                                    {language === 'ko' ? 'ENGLISH' : '한국어'}
                                </button>
                            </div>
                        </div>
                    </header>

                    <main className="max-w-6xl mx-auto px-6 py-10">
                        {!result ? (
                            <div className="bg-white rounded-[2.5rem] shadow-xl border p-8 md:p-12 animate-fade">
                                <RenderOptions label={t.genreLabel} field="genre" list={OPTIONS.genres[language]} selectedValues={formData.genre} onToggle={toggleSelection} onReset={() => setFormData(initialFormState)} />
                                <RenderOptions label={t.eraLabel} field="era" list={OPTIONS.eras[language]} selectedValues={formData.era} onToggle={toggleSelection} />
                                <RenderOptions label={t.moodLabel} field="mood" list={OPTIONS.moods[language]} selectedValues={formData.mood} onToggle={toggleSelection} />
                                <RenderOptions label={t.vocalLabel} field="vocal" list={OPTIONS.vocals[language]} selectedValues={formData.vocal} onToggle={toggleSelection} />
                                <RenderOptions label={t.instLabel} field="instruments" list={OPTIONS.instruments[language]} selectedValues={formData.instruments} onToggle={toggleSelection} isAuto={isAutoInstruments} onAutoToggle={() => setIsAutoInstruments(!isAutoInstruments)} />
                                <RenderOptions label={t.mixLabel} field="mixing" list={OPTIONS.mixingStyles[language]} selectedValues={formData.mixing} onToggle={toggleSelection} isAuto={isAutoMixing} onAutoToggle={() => setIsAutoMixing(!isAutoMixing)} />

                                <div className="grid md:grid-cols-2 gap-8 mb-12 border-t pt-10">
                                    <div>
                                        <label className="block label-text mb-4">{t.langLabel}</label>
                                        <div className="flex gap-2">
                                            {['ko', 'en', 'jp'].map((l, idx) => (
                                                <button key={l} onClick={() => setFormData(prev => ({...prev, lyricsLanguage: l}))}
                                                    className={`flex-1 py-4 rounded-2xl font-black text-xs border ${formData.lyricsLanguage === l ? 'btn-active border-blue-600' : 'bg-gray-50 text-gray-400'}`}>
                                                    {t.langChoices.ko[idx]}
                                                </button>
                                            ))}
                                        </div>
                                    </div>
                                    <div>
                                        <label className="block label-text mb-4">{t.themeLabel}</label>
                                        <textarea className="w-full p-5 bg-gray-50 border rounded-2xl h-[80px] font-bold text-sm outline-none focus:ring-2 focus:ring-blue-500" 
                                            placeholder={t.themePlaceholder} onChange={e => setFormData(prev => ({...prev, theme: e.target.value}))} />
                                    </div>
                                </div>
                                <button onClick={generatePrompt} disabled={isGenerating} className="w-full py-6 bg-black text-white rounded-[2rem] font-black text-xl disabled:opacity-50 hover:bg-blue-600 transition-all shadow-xl">
                                    {isGenerating ? t.loading : t.generateBtn}
                                </button>
                            </div>
                        ) : (
                            <div className="bg-white rounded-[3rem] shadow-2xl border p-8 md:p-12 animate-fade">
                                <div className="flex justify-between mb-8 border-b pb-6">
                                    <h2 className="text-2xl font-black italic text-blue-600 uppercase tracking-tighter">READY TO PLAY</h2>
                                    <button onClick={() => setResult(null)} className="bg-gray-100 px-6 py-2 rounded-full font-black text-xs uppercase hover:bg-gray-200">{t.restart}</button>
                                </div>
                                {['Title', 'Style Prompt', 'Lyrics'].map(key => (
                                    <div key={key} className="mb-8">
                                        <div className="flex justify-between mb-2">
                                            <label className="text-[11px] font-black text-gray-400 uppercase italic tracking-widest">{key}</label>
                                            <button onClick={() => {navigator.clipboard.writeText(p[key.split(' ')[0].toLowerCase()]); alert('복사완료! Copy Done!');}} className="text-blue-500 font-black text-[10px] hover:underline uppercase">COPY</button>
                                        </div>
                                        <div className={`bg-gray-900 text-blue-100 p-6 rounded-2xl font-mono text-sm whitespace-pre-wrap border-2 border-gray-800 shadow-inner`}>{p[key.split(' ')[0].toLowerCase()]}</div>
                                    </div>
                                ))}
                            </div>
                        )}
                    </main>

                    {showHelp && (
                        <div className="fixed inset-0 z-50 flex items-center justify-center p-6 bg-black/60 backdrop-blur-sm animate-fade">
                            <div className="bg-white rounded-[2.5rem] w-full max-w-lg p-8 md:p-10 shadow-2xl relative max-h-[90vh] overflow-y-auto">
                                <button onClick={() => setShowHelp(false)} className="absolute top-8 right-8 text-gray-300 hover:text-black"><i className="fa-solid fa-xmark text-2xl"></i></button>
                                
                                <h3 className="text-2xl font-black italic mb-6 uppercase text-blue-600">사용 설명서</h3>
                                
                                <div className="mb-8 p-5 bg-blue-50 rounded-2xl border border-blue-100">
                                    <h4 className="font-black text-blue-700 mb-3 uppercase flex items-center gap-2">
                                        <i className="fa-solid fa-key"></i>Gemini API KEY 만드는 법
                                    </h4>
                                    <div className="space-y-2 text-xs font-bold text-blue-600/80 leading-relaxed">
                                        <p>1. <a href="https://aistudio.google.com/app/apikey" target="_blank" className="underline text-blue-800">Google AI Studio</a>에 접속합니다.</p>
                                        <p>2. 구글 계정으로 로그인합니다.</p>
                                        <p>3. 사이트 좌측 하단의 <b>"Get API key"</b> 버튼을 클릭합니다.</p>
                                        <p>4. 우측 상단에 <b>"API 키 만들기"</b>를 클릭합니다.</p>
                                        <p>5. 키 이름을 쓰시고 아래 <b>가져온 프로젝트</b>에 프로젝트만들기 클릭, 이름 만들고 최종 키만들기 클릭.</p>
                                        <p>6. 화면 오른쪽 <b>결제설정</b>옆 네모아이콘을 클릭하여 키를 복사하고 이 웹사이트의 <b>API 설정</b>에 붙여넣으세요.</p>
                                        <p className="mt-2 text-[10px] opacity-70">* API 키는 무료로 발급 가능하며, 브라우저에 안전하게 저장됩니다.</p>
                                    </div>
                                </div>

                                <div className="space-y-4 text-sm font-bold text-gray-600">
                                    <p className="flex gap-3"><span className="text-blue-500">01</span> {language === 'ko' ? '원하는 음악 스타일과 요소를 선택하세요.' : 'Select your desired musical styles.'}</p>
                                    <p className="flex gap-3"><span className="text-blue-500">02</span> {language === 'ko' ? 'AI Auto 모드는 테마에 맞는 악기를 자동 추천합니다.' : 'AI Auto mode recommends instruments based on the theme.'}</p>
                                    <p className="flex gap-3"><span className="text-blue-500">03</span> {language === 'ko' ? '구체적인 스토리를 적을수록 결과물의 품질이 좋아집니다.' : 'Detailed stories yield higher quality results.'}</p>
                                    <p className="flex gap-3"><span className="text-blue-500">04</span> {language === 'ko' ? '생성된 내용을 Suno AI에 붙여넣어 노래를 만드세요.' : 'Copy results and paste them into Suno AI.'}</p>
                                </div>
                                <button onClick={() => setShowHelp(false)} className="w-full mt-8 py-4 bg-black text-white rounded-xl font-black uppercase">Close</button>
                            </div>
                        </div>
                    )}

                    {showSettings && (
                        <div className="fixed inset-0 z-50 flex items-center justify-center p-6 bg-black/60 backdrop-blur-sm">
                            <div className="bg-white rounded-[2.5rem] w-full max-w-sm p-10 shadow-2xl relative">
                                <h3 className="text-xl font-black mb-6 italic uppercase">API KEY SETTING</h3>
                                <input type="password" value={apiKey} onChange={e => setApiKey(e.target.value)} placeholder="AIzaSy..." className="w-full border-2 p-4 rounded-xl mb-6 font-mono outline-none focus:border-blue-500" />
                                <button onClick={() => {localStorage.setItem('_nimo_gemini_key', btoa(apiKey).split('').reverse().join('')); setShowSettings(false);}} className="w-full py-4 bg-blue-600 text-white rounded-xl font-black shadow-lg">SAVE</button>
                            </div>
                        </div>
                    )}
                </div>
            );
        };

        const App = () => {
            const [isAuth, setIsAuth] = useState(false);
            const [pw, setPw] = useState('');
            const checkLogin = async () => {
                try {
                    const res = await fetch(`${API_URL}/login`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ password: pw })
                    });
                    const data = await res.json();
                    if (data.success) setIsAuth(true);
                    else alert("비밀번호를 확인 해 주세요.(recheck your password)");
                } catch (e) { alert("Server connection failed"); }
            };

            if (!isAuth) return (
                <div 
                    className="min-h-screen flex flex-col items-center justify-center text-white p-6"
                    style={{
                        backgroundImage: "linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url('https://raw.githubusercontent.com/nimomusic/nimomusic-suno-ai-prompter/main/bg.png')",
                        backgroundSize: 'cover',
                        backgroundPosition: 'top',
                        backgroundRepeat: 'no-repeat',
                        backgroundColor: 'black'
                    }}
                >
                    <h1 className="text-6xl font-black italic mb-10 tracking-tighter">NIMO MUSIC</h1>
                    <div className="w-full max-w-xs space-y-4">
                        <input type="password" value={pw} onChange={e => setPw(e.target.value)} onKeyDown={e => e.key === 'Enter' && checkLogin()} placeholder="PASSWORD" 
                            className="w-full bg-white/10 border border-white/20 p-6 rounded-2xl text-center font-bold tracking-[0.5em] outline-none focus:border-blue-500 backdrop-blur-sm" />
                        <button onClick={checkLogin} className="w-full bg-white text-black py-6 rounded-2xl font-black hover:bg-blue-600 hover:text-white transition-all uppercase">ENTER</button>
                    </div>
                </div>
            );
            return <SunoPromptGenerator userPw={pw} />;
        };

        ReactDOM.createRoot(document.getElementById('root')).render(<App />);
    </script>
</body>
</html>








